using Test: @test

using Omics

# ---- #

Omics.XSample.rea

# ---- #

Omics.XSample.align

# ---- #

# 711.029 ns (22 allocations: 2.02 KiB)
# 703.199 ns (22 allocations: 1.97 KiB)
# 712.475 ns (22 allocations: 1.95 KiB)
# 680.099 ns (22 allocations: 1.92 KiB)

for (fi, f1_, s1_, v1, f2_, s2_, v2, re) in (
    (
        0,
        ["R1", "R2"],
        ["C1", "C2", "C3"],
        [
            1 3 5
            2 4 6
        ],
        ["R3", "R4"],
        ["C4", "C5", "C6"],
        [
            7 9 11
            8 10 12
        ],
        (
            ["R1", "R2", "R3", "R4"],
            ["C1", "C2", "C3", "C4", "C5", "C6"],
            [
                1 3 5 0 0 0
                2 4 6 0 0 0
                0 0 0 7 9 11
                0 0 0 8 10 12
            ],
        ),
    ),
    (
        0,
        ["R1", "R2"],
        ["C1", "C2", "C3"],
        [
            1 3 5
            2 4 6
        ],
        ["R2", "R3"],
        ["C4", "C5", "C6"],
        [
            7 9 11
            8 10 12
        ],
        (
            ["R1", "R2", "R3"],
            ["C1", "C2", "C3", "C4", "C5", "C6"],
            [
                1 3 5 0 0 0
                2 4 6 7 9 11
                0 0 0 8 10 12
            ],
        ),
    ),
    (
        0,
        ["R1", "R2"],
        ["C1", "C2", "C3"],
        [
            1 3 5
            2 4 6
        ],
        ["R3", "R4"],
        ["C2", "C3", "C4"],
        [
            7 9 11
            8 10 12
        ],
        (
            ["R1", "R2", "R3", "R4"],
            ["C1", "C2", "C3", "C4"],
            [
                1 3 5 0
                2 4 6 0
                0 7 9 11
                0 8 10 12
            ],
        ),
    ),
    (
        0,
        ["R1", "R2"],
        ["C1", "C2", "C3"],
        [
            1 3 5
            2 4 6
        ],
        ["R2", "R3"],
        ["C2", "C3", "C4"],
        [
            7 9 11
            8 10 12
        ],
        (
            ["R1", "R2", "R3"],
            ["C1", "C2", "C3", "C4"],
            [
                1 3 5 0
                2 7 9 11
                0 8 10 12
            ],
        ),
    ),
)

    @test Omics.XSample.joi(fi, f1_, s1_, v1, f2_, s2_, v2) == re

    #@btime Omics.XSample.joi($fi, $f1_, $s1_, $v1, $f2_, $s2_, $v2)

end
